<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge, chrome=1.0">
        <title>Ajax 5일차 - jQuery Ajax(XML)</title>
        <script src="./jquery.js"></script>
        <!--
            ajax 기본코드 있음. (Jquery, Javascript)
            Jquery-ajax : XML, JSON
            Jquery 배열시 루프 : each
        -->
        <script>
            $(function(){
                let $data;  // backend 데이터를 확장함수 리턴 받아서 처리할 때 사용함

                $.ajax({  // ajax를 사용하기 위한 Jquery ajax 전용함수. (jquery 엔진에서 바꿀 수 있음)
                    url:"jndex1.xml",  // JavaScript의 open과 동일
                    cache:false,  // true(기본), false : 파일을 local에 저장하지 않음. 캐쉬 메모리 찾아볼 것.
                    type:"GET",   // GET, POST, PUT, DELETE
                    dataType:"XML",  // xml, json, txt, html (파일 속성명)
                    success:function(s){  // 정상적으로 데이터를 load할 경우 작동됨 (JS : status == 200)

                        // console.log(s.find("user")("mname").text());
                        // console.log($(s).find("user").text());
                        // console.log($(s).find("user").eq(0).text());
                        // console.log($(s).find("mname").text());
                        // console.log($(s).find("mname").eq(0).text());

                        var $mname,$likes,$hobby;
                        $(s).find("user").each(function($a,$b){
                            // console.log($a) // 노드
                            // console.log($b) // 배열
                            $mname = $(this).find("mname").text();  // find : JS(getElementByTagName)
                            $likes = $(this).find("likes").text();
                            $hobby = $(this).find("hobby").text();
                            console.log($mname,$likes,$hobby);

                            $("#userlist > li:eq("+ ($a +1) +") > span").eq(0).text($mname);
                            $("#userlist > li:eq("+ ($a +1) +") > span").eq(1).text($likes);
                            $("#userlist > li:eq("+ ($a +1) +") > span").eq(2).text($hobby);
                        })
                    },
                    error:function(){  // 파일을 load하지 못할 경우 error이 작동함
                        alert("통신에러");
                    }
                })
            })
        </script>
        <style>
            * { margin:0; padding:0; }
            ul { list-style:none; margin:0; padding:0; }
            ul > li { width: 100%; height: 30px; line-height: 30px; }
            ul > li > span { height: 30px; line-height: 30px; display: inline-block; text-align:center; font-size: 12px; border: 1px solid #ccc; box-sizing: border-box;}
            ul > li > span:nth-of-type(1) {width: 100px;}
            ul > li > span:nth-of-type(2) {width: 190px;}
            ul > li > span:nth-of-type(3) {width: 190px;}
        </style>
    </head>
    <body>
        <p>사용자 정보 리스트</p>
        <ul id="userlist">
            <li>
                <span>고객명</span>
                <span>좋아하는 과일</span>
                <span>취미</span>
            </li>
            <li>
                <span></span>
                <span></span>
                <span></span>
            </li>
            <li>
                <span></span>
                <span></span>
                <span></span>
            </li>
            <li>
                <span></span>
                <span></span>
                <span></span>
            </li>
            <li>
                <span></span>
                <span></span>
                <span></span>
            </li>
            <li>
                <span></span>
                <span></span>
                <span></span>
            </li>
            <li>
                <span></span>
                <span></span>
                <span></span>
            </li>
            <li>
                <span></span>
                <span></span>
                <span></span>
            </li>
        </ul>
    </body>
</html>